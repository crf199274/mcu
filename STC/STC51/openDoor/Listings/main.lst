C51 COMPILER V9.60.7.0   MAIN                                                              03/19/2023 16:26:27 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\software\keil5_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Lis
                    -tings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "main.h"
   2          #include "string.h"
   3          
   4          void init(void);
   5          void Delay10ms();   //@11.0592MHz
   6          void FstartMotor(void);
   7          void RstartMotor(void);
   8          void stopMotor(void);
   9          unsigned char usart_WaitRecive(void);
  10          void cleanUsartBuf(void);
  11          
  12          void main()
  13          {
  14   1        init();
  15   1        
  16   1        FstartMotor();
  17   1        
  18   1      }
  19          
  20          unsigned char usart_WaitRecive()
  21          {
  22   1          if(usart_cnt == 0)
  23   1            return 0;
  24   1          
  25   1          if(usart_cnt == usart_cntPre)
  26   1          {
  27   2            usart_cnt = 0;
  28   2            return 1; 
  29   2          }
  30   1          
  31   1          usart_cntPre = usart_cnt;
  32   1          
  33   1          return 0;
  34   1      }
  35          
  36          void cleanUsartBuf()
  37          {
  38   1        memset(usart_buf,0,sizeof(usart_buf));
  39   1        usart_cnt = 0;
  40   1      }
  41          
  42          void Usart() interrupt 4
  43          {
  44   1        if(RI==1)
  45   1        {
  46   2          if(usart_cnt>=sizeof(usart_buf))
  47   2            usart_cnt = 0;
  48   2          usart_buf[usart_cnt++] = SBUF;
  49   2          RI = 0;
  50   2        }
  51   1      }
  52          
  53          void USARTinit(void)
  54          {
C51 COMPILER V9.60.7.0   MAIN                                                              03/19/2023 16:26:27 PAGE 2   

  55   1        TMOD=0x20;
  56   1        TH1=0xFA;
  57   1        TL1=0xFA;
  58   1        TR1=1;
  59   1        PCON|=0x80;
  60   1        SCON|=0x50;
  61   1        ES=1;
  62   1        EA=1;
  63   1      
  64   1      }
  65          
  66          void init(void)
  67          {
  68   1        IT0 = 1;                        //set INT0 int type (1:Falling 0:Low level)
  69   1        EX0 = 1;                        //enable INT0 interrupt
  70   1        EA = 1;                         //open global interrupt switch
  71   1        
  72   1        FEN_MOTOR1 = 1;
  73   1        FEN_MOTOR2 = 0;
  74   1        REN_MOTOR1 = 1;
  75   1        REN_MOTOR2 = 0;
  76   1        EN_MOTOR = 0;
  77   1        TDP1 = 1;
  78   1        TDP2 = 1;
  79   1        USARTinit();
  80   1      }
  81          
  82          void FstartMotor(void)
  83          {
  84   1        REN_MOTOR1 = 1;
  85   1        REN_MOTOR2 = 0;
  86   1        Delay10ms();
  87   1        FEN_MOTOR1 = 0;
  88   1        FEN_MOTOR2 = 1;
  89   1      }
  90          
  91          void RstartMotor(void)
  92          {
  93   1        FEN_MOTOR1 = 1;
  94   1        FEN_MOTOR2 = 0;
  95   1        Delay10ms();
  96   1        REN_MOTOR1 = 0;
  97   1        REN_MOTOR2 = 1;
  98   1      }
  99          
 100          void stopMotor(void)
 101          {
 102   1        FEN_MOTOR1 = 1;
 103   1        FEN_MOTOR2 = 0;
 104   1        Delay10ms();
 105   1        REN_MOTOR1 = 1;
 106   1        REN_MOTOR2 = 0;
 107   1      }
 108          
 109          //External interrupt0 service routine
 110          void exint0() interrupt 0           //(location at 0003H)
 111          {
 112   1          P0++;
 113   1      }
 114          
 115          void Delay10ms()    //@11.0592MHz
 116          {
C51 COMPILER V9.60.7.0   MAIN                                                              03/19/2023 16:26:27 PAGE 3   

 117   1        unsigned char i, j;
 118   1      
 119   1        i = 18;
 120   1        j = 235;
 121   1        do
 122   1        {
 123   2          while (--j);
 124   2        } while (--i);
 125   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    207    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     20    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
