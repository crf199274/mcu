C51 COMPILER V9.60.7.0   FUNCTION3                                                         04/26/2023 01:52:59 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE FUNCTION3
OBJECT MODULE PLACED IN .\Objects\function3.obj
COMPILER INVOKED BY: E:\software\keil5_v5\C51\BIN\C51.EXE function3\function3.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\
                    -functionSwitching;.\function1;.\LCD;.\Delay;.\ADC;.\function2;.\function3) DEBUG OBJECTEXTEND PRINT(.\Listings\function3
                    -.lst) TABS(2) OBJECT(.\Objects\function3.obj)

line level    source

   1          #include "function3.h"
   2          
   3          void updata_LCD3(void);
   4          void updataPwmOcc(unsigned int i);
   5          
   6          void function3()
   7          {
   8   1        PWMSET = 0x01;          //使能PWM模块(必须先使能模块后面的设置才有效)
   9   1        
  10   1        P_SW2 = 0x80;
  11   1        PWMCKS = 0x00;          //PWM时钟为系统时钟
  12   1        PWMC = 1000;            //设置PWM周期为1000H 个PWM时钟
  13   1        PWM1T1 = 0x0000;        //在计数值为0000H 地方PWM1 通道输出低电平
  14   1        PWM1T2 = 0x0000;        //在计数值为0000H 地方PWM1 通道输出高电平
  15   1        PWM2T1 = 0x0000;        //在计数值为0000H 地方PWM2 通道输出低电平
  16   1        PWM2T2 = 0x0000;        //在计数值为0000H 地方PWM2 通道输出高电平
  17   1        PWM1CR = 0x80;          //使能PWM1 输出
  18   1        PWM2CR = 0x80;          //使能PWM2 输出
  19   1        P_SW2 = 0x00;
  20   1        
  21   1        PWMCFG = 0x01;          //启动PWM模块
  22   1        
  23   1        LCD_Fill(0,0,LCD_W,LCD_H,BLACK);
  24   1        
  25   1        while(1)
  26   1        {
  27   2          
  28   2          updata_LCD3();
  29   2          
  30   2          if(falg2)
  31   2          {
  32   3            falg2 = 0;
  33   3            updataPwmOcc(M_Freq);
  34   3          }
  35   2          
  36   2          if(MODE!=2)
  37   2            break;
  38   2        }
  39   1        
  40   1        P_SW2 = 0x80;
  41   1        PWMCFG = 0x00;          //停止PWM模块
  42   1        PWM1CR = 0x00;          //失能PWM1 输出
  43   1        PWM2CR = 0x00;          //失能PWM2 输出
  44   1        P_SW2 = 0x00;
  45   1        
  46   1      }
  47          
  48          void updata_LCD3(void)
  49          {
  50   1        char buf[20];
  51   1        
  52   1        memset(buf,0,20);
  53   1        sprintf(buf,"OCC: %-3d%%",M_Freq);
C51 COMPILER V9.60.7.0   FUNCTION3                                                         04/26/2023 01:52:59 PAGE 2   

  54   1        LCD_ShowString(0,0,buf,BLUE,BLACK,16,0);//第一行 -- 8x16的显示单元显示ASCII码
  55   1        
  56   1      }
  57          
  58          void updataPwmOcc(unsigned int i)
  59          {
  60   1        
  61   1        P_SW2=0X80;
  62   1        
  63   1        PWMCFG = 0x00;          //关闭PWM模块
  64   1        
  65   1        if(MODE2)
  66   1        {
  67   2          PWM1T1 = (int)(1000*(i/100.0));
  68   2          PWM1T2 = 0x0000;
  69   2          
  70   2          PWM2T1 = 0x0000;
  71   2          PWM2T2 = 0x0000;
  72   2        }else{
  73   2          PWM1T1 = 0x0000;
  74   2          PWM1T2 = 0x0000;
  75   2          
  76   2          PWM2T1 = (int)(1000*(i/100.0));
  77   2          PWM2T2 = 0x0000;
  78   2        }
  79   1        
  80   1        PWMCFG = 0x01;          //启动PWM模块
  81   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    355    ----
   CONSTANT SIZE    =     12    ----
   XDATA SIZE       =   ----      22
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
